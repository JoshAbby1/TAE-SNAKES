<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Classic Snake Game</title>
<style>
  body {
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    background: #222;
    color: #fff;
    font-family: sans-serif;
    text-align: center;
    touch-action: none;
  }
  h1 { margin: 10px 0 5px; font-size: 24px; }
  p, #author { margin: 0 0 5px; font-size: 16px; }
  canvas { background: #000; display: block; margin-top: 10px; }
  #score { margin: 5px; font-size: 20px; }
  .controls {
    display: grid;
    grid-template-columns: 50px 50px 50px;
    grid-template-rows: 50px 50px;
    gap: 8px;
    margin-top: 10px;
  }
  .controls button {
    font-size: 18px;
    padding: 8px;
    cursor: pointer;
    background: #555;
    color: #fff;
    border: none;
    border-radius: 5px;
  }
  #restartBtn {
    margin-top: 10px;
    padding: 8px 16px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>
<h1>Snake Game</h1>
<p>Use arrow keys or buttons to move. Eat the red food and grow!</p>
<p id="author">Made by @nortydigitalcrew</p>
<div id="score">Score: 0</div>
<canvas id="gameCanvas"></canvas>

<div class="controls">
  <div></div><button id="upBtn">↑</button><div></div>
  <button id="leftBtn">←</button><div></div><button id="rightBtn">→</button>
  <div></div><button id="downBtn">↓</button><div></div>
</div>

<button id="restartBtn">Restart</button>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const cellSize = 20;
let rows, cols;
let snake;
let food;
let direction;
let score;
let gameInterval;
let speed = 350; // start slow
let startTime;

function resizeCanvas() {
  // Max height 50% of screen so controls fit
  const maxHeight = window.innerHeight * 0.5;
  let width = maxHeight * 4 / 5; // 4:5 ratio
  let height = maxHeight;
  const maxWidth = window.innerWidth * 0.9;
  if (width > maxWidth) {
    width = maxWidth;
    height = width * 5 / 4;
  }
  canvas.width = Math.floor(width / cellSize) * cellSize;
  canvas.height = Math.floor(height / cellSize) * cellSize;
  cols = canvas.width / cellSize;
  rows = canvas.height / cellSize;
}

function init() {
  resizeCanvas();
  snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
  direction = 'RIGHT';
  placeFood();
  score = 0;
  document.getElementById('score').innerText = 'Score: 0';
  speed = 350;
  startTime = Date.now();

  clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop, speed);
}

function placeFood() {
  let x, y;
  do {
    x = Math.floor(Math.random() * cols);
    y = Math.floor(Math.random() * rows);
  } while (snake.some(segment => segment.x === x && segment.y === y));
  food = {x, y};
}

function updateSpeed() {
  const elapsed = (Date.now() - startTime) / 1000; 
  if (elapsed > 60 && speed > 220) { // speed up gradually
    speed = 220;
    clearInterval(gameInterval);
    gameInterval = setInterval(gameLoop, speed);
  }
}

function gameLoop() {
  updateSpeed();

  const head = {...snake[0]};

  if (direction === 'UP') head.y--;
  else if (direction === 'DOWN') head.y++;
  else if (direction === 'LEFT') head.x--;
  else if (direction === 'RIGHT') head.x++;

  if (head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows ||
      snake.some(segment => segment.x === head.x && segment.y === head.y)) {
    clearInterval(gameInterval);
    alert('Game Over! Final Score: ' + score);
    return;
  }

  snake.unshift(head);

  if (head.x === food.x && head.y === food.y) {
    score++;
    document.getElementById('score').innerText = 'Score: ' + score;
    placeFood();
  } else {
    snake.pop();
  }

  draw();
}

function draw() {
  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = '#0f0';
  snake.forEach(segment => ctx.fillRect(segment.x*cellSize, segment.y*cellSize, cellSize, cellSize));

  ctx.fillStyle = '#f00';
  ctx.fillRect(food.x*cellSize, food.y*cellSize, cellSize, cellSize);
}

// Keyboard controls
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowUp' && direction !== 'DOWN') direction = 'UP';
  if (e.key === 'ArrowDown' && direction !== 'UP') direction = 'DOWN';
  if (e.key === 'ArrowLeft' && direction !== 'RIGHT') direction = 'LEFT';
  if (e.key === 'ArrowRight' && direction !== 'LEFT') direction = 'RIGHT';
});

// Button controls
document.getElementById('upBtn').addEventListener('click', () => { if(direction!=='DOWN') direction='UP'; });
document.getElementById('downBtn').addEventListener('click', () => { if(direction!=='UP') direction='DOWN'; });
document.getElementById('leftBtn').addEventListener('click', () => { if(direction!=='RIGHT') direction='LEFT'; });
document.getElementById('rightBtn').addEventListener('click', () => { if(direction!=='LEFT') direction='RIGHT'; });

// Restart button
document.getElementById('restartBtn').addEventListener('click', init);

// Start game
init();
window.addEventListener('resize', () => {
  resizeCanvas();
  draw();
});

// Prevent zoom and touch scrolling
document.body.addEventListener('touchstart', e => e.preventDefault(), {passive:false});
document.body.addEventListener('touchmove', e => e.preventDefault(), {passive:false});
</script>
</body>
</html>